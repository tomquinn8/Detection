#!/usr/bin/env python3

# Take URLs on std in and check banner to see if server is running Apache 2.4.49.
# Threaded for performance reasons

import sys
import requests
import concurrent.futures

# Disable certificate warnings
requests.packages.urllib3.disable_warnings(requests.packages.urllib3.exceptions.InsecureRequestWarning)

def testURL(url):
    try:
        response = requests.get(url, timeout = 10, verify = False)
        if 'Apache/2.4.49' in response.headers['Server']:
            print(f'[*] Potentially Vulnerable [*] - {url}')
    except Exception:
        pass

# Take URLs from std in
urls = []
for line in sys.stdin:
    urls.append(line.rstrip())

# Threaded for performance
with concurrent.futures.ThreadPoolExecutor(max_workers = 10) as executor:
    executor.map(testURL, urls)
